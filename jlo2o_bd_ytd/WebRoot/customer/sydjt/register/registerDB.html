<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>注册基础信息录入</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="/customer/sydjt/css/public.css" />
<script type="text/javascript" src="/js/jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="/js/json2.js"></script>
<script type="text/javascript" src="/js/commons.js"></script>
<script type="text/javascript" src="/js/jquery.cookie.js"></script>
<script type="text/javascript" src="/customer/qfy/js/pubJson.js"></script>
<style type="text/css">
ul.reg_info {
	float: left;
	width: 230px;
	height: 223px;
	margin: 0px 0;
	position: relative;
}

ul.reg_info li {
	float: left;
	margin-bottom: 10px;
}

ul.reg_info li.ts {
	float: left;
	width: 216px;
	border: 1px solid #f9d2a3;
	background-color: #faf3ea;
	color: #ee0e0e;
	min-height: 30px;
	line-height: 30px;
	position: absolute;
	top: 153px;
	display: none;
}

ul.reg_info li.ts b {
	float: left;
	width: 16px;
	height: 16px;
	background-color: #ee0e0e;
	color: #fff;
	border-radius: 50%;
	line-height: 16px;
	text-align: center;
	margin: 7px;
	font-weight: 100;
	font-size: 14px;
}

ul.reg_info li span {
	float: left;
	width: 37px;
	height: 37px;
	background-color: #000;
	background: url(../images/index_login_ico.png) #a1a1a1;
	background-position: -1.5px -2.5px;
	cursor: pointer;
}

ul.reg_info li span.pwd {
	background-position: -1.5px -42.5px
}

ul.reg_info li span.zhlx {
	background-position: -1.5px -83.5px
}

ul.reg_info li span:hover {
	background-color: #888;
}

ul.reg_info li select {
	float: left;
	width: 181px;
	border: 1px solid #e4e4e4;
	height:37px; line-height:37px; padding:6px;
	color: #666;
}

ul.reg_info li select:hover {
	border-color: #a1a1a1;
}

ul.reg_info li input.text {
	float: left;
	width: 169px;
	border: 1px solid #e4e4e4;
	height: 35px;
	padding: 0 5px;
	color: #666;
}

ul.reg_info li input.text:hover {
	border-color: #a1a1a1;
}

ul.reg_info li input.checkbox {
	float: left;
	border: 1px solid #e4e4e4;
	margin: 2px 10px 0 0;
	color: #666;
	padding: 0px;
}

ul.reg_info li label {
	float: left;
	width: 160px;
}

ul.reg_info li label a.xy {
	margin-left: 5px;
	color: #ff8800;
}

ul.reg_info li label a.xy:hover {
	text-decoration: underline;
}

ul.reg_info li a.reg_bot_yes {
	float: left;
	width: 214px;
	height: 35px;
	line-height: 35px;
	font-size: 15px;
	border: 1px solid #c76e09;
	background-color: #ff8800;
	text-align: center;
	color: #fff;
	font-family: "microsoft yahei";
	box-shadow: 0px 0px 2px #ccc;
	margin-top: 10px;
	text-shadow: 0px 0 1px #666
}

ul.reg_info li a.reg_bot_yes:hover {
	background-color: #ee8800;
}

ul.reg_info li a.reg_bot_no {
	float: left;
	width: 214px;
	height: 35px;
	line-height: 35px;
	font-size: 15px;
	border: 1px solid #aaa;
	background-color: #ccc;
	text-align: center;
	color: #fff;
	font-family: "microsoft yahei";
	box-shadow: 0px 0px 2px #ccc;
	margin-top: 10px;
	text-shadow: 0px 0 1px #666
}

  .foce{

  	height:38px;line-height:38px;font-size:16px;

  }


  .seFoce{
   padding-bottom: 10px;


  }


</style>
</head>
<body>
		<ul class="reg_info">
			<li class="ts">
				<b>×</b><label></label>
			</li>
			<li>
				<span title="选择身份" class="zhlx"></span>
				<select id="gslx" name="gslx">
					<!--<option value="">选择身份</option>
					<option value="43">生产厂家</option>
					<option value="44">维修企业</option>
					<option value="42">经销企业</option>-->
					<option value="24">个人用户</option>
				</select>
			<li>
				<span title="登录帐号"></span>
				<input class="text foce" id="username" name="username" type="text" placeholder="请输数字，英文登陆账号" id="reg_userName"  onKeyUp="value=value.replace(/[^\w\.\/]/ig,'')" onblur="checkOperator()" onkeypress="return userName_onkeypress(event)"/>
			</li>
			<li>
				<span class="pwd" title="登录密码"></span>
				<input id="a1" class="text foce" onKeyUp="value=value.replace(/[^\w\.\/]/ig,'')" onblur="checkPassword()" type="password" placeholder="至少6位的数字字母组合密码" onkeypress="return password_onkeypress(event)"/>
				<input type="text foce" id="password" name="password" style="display: none;" />
			</li>
			<li>
				<span class="pwd"  title="确认密码"></span>
				<input id="a2" class="text foce" onblur="checkRepassword()" type="password" placeholder="确认密码" onkeypress="return passsword_onkeypress(event)"/>
				<input type="text" id="repassword" name="repassword" style="display: none;" />
			</li>
			<li onclick="register()">
				<a class="reg_bot_yes" style="cursor:pointer;">立即注册</a>
			</li>
		</ul>
</body>
<script type="text/javascript">
function checkPassword(){
  	var password=$("#a1").val();
  	var str=/[A-Za-z].*[0-9]|[0-9].*[A-Za-z]/;
	if(str.test(password)){
		$("#password").val(password);
	}else{
		$("#a1").val("");
		alert("密码需为至少6位的数字字母组合！");
	}
}

//判断两次密码是否相同
function checkRepassword(){
	var password=$("#a1").val();
  	var repassword=$("#a2").val();
  	if(password != repassword){
  		alert("两次输入密码不同");
  		return true;
  	}
  	$("#repassword").val(repassword);
}

//判断用户名是否存在
function checkOperator(){
	if($("#username").val().length > 0){
		var json = {};
		json["RYDM"]=$("#username").val();
		var url = "/Register/checkUserExist.action?json="+JSON.stringify(json);
		ajaxQ({
			"url" : url,
			"callback" : function(returnVal){
				if(returnVal != "undefined"){
					if(returnVal.num == "1"){
						alert("用户已存在!");
						$("#username").val("");
						return false;
					}else{
						return true;
					}
				}
			}
		});
	}
}

//判断输入项是否合法
function checkNull(){
    var flag = true;
	if($("#gslx").val().length == 0){
		alert("请选择身份");
		flag=false;
	}
	if($("#username").val().length == 0){
		alert("请输入用户名");
		flag=false;
	}
	if($("#password").val().length == 0){
		alert("请输入密码");
		flag=false;
	}
	if($("#repassword").val().length == 0){
		alert("请确认密码");	
		flag=false;
	}
	return flag;
}

//注册方法
function register(){
	var flag = checkNull();
	if(flag == true){
		//将值存入cookies
		var userInfo = {};
		userInfo["XTCZY01"] = $("#username").val();
		userInfo["XTCZY02"] = $("#password").val();
		if(!($("#password").val().length>=6&&$("#password").val().length<=20)){
			alert("登陆密码6到20位，请重新输入");
			return;
		}
		userInfo["ZCXX02"] = $("#username").val();
		userInfo["GSLX"] = $("#gslx").val();
		userInfo["SJLY"] = "0";
		userInfo["ZCGS01"]="2";
		//弹出遮罩层
		top.openWait();
		//生成O2O账号数据
		url = "/Register/insertQuickRegister.action?XmlData="+JSON.stringify(userInfo);
		ajaxQ({
			"url" : url,
			"callback" : function(returnVal){
				if(returnVal == "undefined"){
					alert("汽服云生成账号失败");
					return;
				}else{
					var url = "/customer/sydjt/register/registerPhone.html?XTCZY01="+$("#username").val()+"&ZCXX01="+returnVal.ZCXX01+"&XTCZY02="+$("#password").val();
					window.open(url,"_parent");
				}
			}
		});
		//关闭遮罩层
		top.closeWait();
	}
}
$(function(){

if(navigator.userAgent.indexOf("MSIE")>0)  
{   
      
    if(navigator.userAgent.indexOf("MSIE 8.0")>0)  
    {  

    	//$("#gslx").css("padding-bottom","10px");
    
    } else{

    	//$("#gslx").css("padding-bottom","0px");
    }
   

}



})
function userName_onkeypress(event){   
    if(event.keyCode==13)   
    	$("#a1").focus();   
}  
function password_onkeypress(event){  
    if(event.keyCode==13)  
    	$("#a2").focus();  
} 
function passsword_onkeypress(event){  
    if(event.keyCode==13)
    	{
    	$("#a2").blur(); 
    	register();   
    	}
} 


</script>
</html>